<div>
    <div>
        <div ng-repeat="(messageID, message) in user.messages.unseen track by $index">
            messageID: {{ messageID }}<br/>
            subject: {{ message.subject }}<br/>
            users: {{ message.users }}<br/>

            <div ng-repeat="(timestamp, contrib) in message.conversation">
                 [{{ timestamp | date:'shortTime'  }}] {{ contrib.user }}: {{ contrib.text }}
            </div>

            <div class="form-group">
                <label>Message:</label>
                <textarea ng-model="text[$index]"></textarea>
            </div>

            <button ng-click="sendMessage(messageID, $index)">Send</button>
            <hr/>
        </div>

    </div>

    <div>
        <h4>Start Conversation</h4>
        {{ users }}
        <fieldset>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label>To:</label>
                        <select ng-model="sendTo" multiple="multiple">
                            <option ng-repeat="username in users" value="{{ username }}">{{ username }}</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Subject:</label>
                        <input type="text" ng-model="subject" />
                    </div>

                    <div class="form-group">
                        <label>Message:</label>
                        <textarea ng-model="text.new"></textarea>
                    </div>

                    <button ng-click="startConversation()">Send</button>
                </div>
            </div>


        </fieldset>

    </div>

</div>